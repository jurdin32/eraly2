{% extends 'Store/demo-shop-8.html' %}
{% load static %}
{% load productosTags %}
{% block content %}
    <div class="modal fade" id="formModal" tabindex="-1" role="dialog" aria-labelledby="formModalLabel"
         aria-hidden="true">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button>
                    <h4 class="modal-title" id="formModalLabel">Calificar</h4>
                    <hr>
                </div>
                <form id="demo-form" method="post" action="/store/details/?hash={{ producto.hash }}"
                      class="form-horizontal mb-lg">
                    {% csrf_token %}
                    <div class="modal-body">
                        <div class="form-group mt-lg">
                            <label class="col-sm-3 text-left text-sm-right mb-0">Calificación</label>
                            <div class="col-sm-9">
                                <div style="font-size: 20px" class='starrr2'></div>
                                <span class="your-choice-was" style="">Has seleccionado <input name="rata"
                                                                                               style="border: none;width: 15px"
                                                                                               readonly="readonly"
                                                                                               required="required"
                                                                                               type="text"
                                                                                               class="choice"></input> estrellas.</span>
                            </div>
                        </div>
                        <div class="form-group row">
                            <label class="col-sm-3 text-left text-sm-right mb-0">Comentario</label>
                            <div class="col-sm-9">
                                <textarea rows="5" style="resize: none" class="form-control" name="comentario"
                                          placeholder="Escriba un comentario" required="required"></textarea>
                            </div>
                        </div>

                    </div>
                    <div class="modal-footer">
                        <button type="button" class="btn btn-info" data-dismiss="modal">Salir</button>
                        <button type="submit" class="btn btn-primary">Registrar</button>
                    </div>
                </form>
            </div>
        </div>
    </div>


    <section class="page-header mb-lg">

        <div class="container">
            <ul class="breadcrumb">
                <li><a href="/store/">Inicio</a></li>
                <li>
                    <a href="/store/category/?ctgry={{ producto.subcategoria.categoria.id }}">{{ producto.subcategoria.categoria.nombre }}</a>
                </li>
                <li class="active">{{ producto.subcategoria.nombre }}</li>
            </ul>
        </div>
    </section>

    <div class="container">
        <div class="row">
            <div class="col-md-9">
                <div class="product-view">
                    <div class="product-essential">
                        <div class="row">
                            <div class="product-img-box col-sm-5">
                                <div class="product-img-box-wrapper">
                                    <div class="product-img-wrapper">
                                        <img id="product-zoom"
                                             src="/media/{{ producto.imagen }}"
                                             data-zoom-image="/media/{{ producto.imagen }}"
                                             alt="{{ producto.nombre }}">
                                    </div>
                                    <a href="#" class="product-img-zoom" title="Zoom">
                                        <span class="glyphicon glyphicon-search"></span>
                                    </a>
                                </div>

                                <div class="owl-carousel" id="productGalleryThumbs">
                                    <div class="product-img-wrapper">

                                        {% if producto.imagen %}
                                        <a href="#" data-image="/media/{{ producto.imagen }}"
                                           data-zoom-image="/media/{{ producto.imagen }}"
                                           class="product-gallery-item">
                                            <img src="/media/{{ producto.imagen }}" alt="product">
                                        </a>
                                        {% else %}
                                            <a href="#" data-image="{% static 'noimagen.jpg' %}"
                                           data-zoom-image="{% static 'noimagen.jpg' %}"
                                           class="product-gallery-item">
                                            <img src="{% static 'noimagen.jpg' %}" alt="product">
                                        </a>
                                        {% endif %}
                                    </div>
                                {% if producto.imagen %}
                                    {% for imagen in producto.imagenesproducto_set.all %}
                                        <div class="product-img-wrapper">
                                            <a href="#" data-image="/media/{{ imagen.imagen }}"
                                               data-zoom-image="/media/{{ imagen.imagen }}"
                                               class="product-gallery-item">
                                                <img src="/media/{{ imagen.imagen }}" alt="product">
                                            </a>
                                        </div>
                                    {% endfor %}
                                {% else %}
                                    <div class="product-img-wrapper">
                                            <a href="#" data-image="{% static 'noimagen.jpg' %}"
                                               data-zoom-image="{% static 'noimagen.jpg' %}"
                                               class="product-gallery-item">
                                                <img src="{% static 'noimagen.jpg' %}" alt="product">
                                            </a>
                                        </div>
                                {% endif %}
                                </div>
                            </div>

                            <div class="product-details-box col-sm-7">
                                <h1 class="product-name">
                                    {{ producto.nombre }}
                                </h1>

                                <div class="product-rating-container">
                                    <div class="product-ratings">
                                        <div class="">
                                            <div class='starrr'></div>
                                        </div>
                                    </div>
                                    <div class="review-link">
                                        <a href="#" class="review-link-in" rel="nofollow">
                                            <span class="count">{% contador_producto producto.id %} </span>
                                            Calificaciones</a> |
                                        <a href="#" data-toggle="modal" data-target="#formModal"
                                           class="write-review-link" rel="nofollow">Agregar Calificación</a>
                                    </div>
                                </div>

                                <div class="product-short-desc" style="text-align: justify">
                                    <p>{{ producto.descripcion|safe }}</p>
                                </div>

                                <div class="product-detail-info">
                                    <div class="product-price-box">
                                        {#<span class="old-price">$99.00</span>#}
                                        <span class="product-price">${{ producto.precios_set.first.total }}</span>
                                    </div>
                                    <p class="availability">
                                        <span class="font-weight-semibold">Disponibilidad:</span>
                                        {% stock producto.id %} en Stock
                                    </p>
                                </div>

                                <div class="product-actions">
                                    <div class="product-detail-qty">
                                        <input type="number" value="1" min="1" max="{% stock producto.id %}"
                                               class="vertical-spinner" style="width: 50px;">
                                    </div>
                                    <a href="#" class="addtocart" title="Add to Cart">
                                        <i class="fa fa-shopping-cart"></i>
                                        <span>Agregar al Carrito</span>
                                    </a>

                                    <div class="actions-right">
                                        <a href="#" class="addtowishlist" title="Add to Wishlist">
                                            <i class="fa fa-heart"></i>
                                        </a>
                                    </div>
                                </div>

                                <div class="product-share-box">
                                    <div class="addthis_inline_share_toolbox"></div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="tabs product-tabs">
                        <ul class="nav nav-tabs">
                            <li class="active">
                                <a href="#product-desc" data-toggle="tab">Descripción</a>
                            </li>
                            {% if producto.detallesTecnicos %}
                                <li>
                                    <a href="#product-tec" data-toggle="tab">Detalles Técnicos</a>
                                </li>
                            {% endif %}
                            <li>
                                <a href="#product-reviews" data-toggle="tab">Calificaciones</a>
                            </li>
                        </ul>
                        <div class="tab-content">
                            <div id="product-desc" class="tab-pane active">
                                <div class="product-desc-area">
                                    {{ producto.descripcion|safe }}<br>
                                    {% if producto.marca %}
                                        Marca: {{ producto.marca }}<br>
                                    {% endif %}
                                    {% if producto.talla %}
                                        Tallas: {{ producto.talla }}<br>
                                    {% endif %}

                                    {% if producto.talla %}
                                        Dimensiones: {{ producto.dimension }}<br>
                                    {% endif %}
                                    {% if  producto.colores_set.all %}
                                        Colores:
                                        <ul>
                                            {% for color in producto.colores_set.all %}
                                                <li>{{ color }}</li>
                                            {% endfor %}
                                        </ul>
                                    {% endif %}

                                </div>
                            </div>
                            {% if producto.detallesTecnicos %}
                                <div id="product-tec" class="tab-pane">
                                    {{ producto.detallesTecnicos|safe }}
                                </div>
                            {% endif %}
                            <div id="product-reviews" class="tab-pane">
                                <div class="collateral-box">
                                    <ul class="list-unstyled">
                                        <span class="your-choice" style="">Según la opinión de los usuarios, se ha calificado el producto con: <div class='starrr'></div> (<span class="choic"></span> estrellas).</span>
                                    </ul>
                                </div>

                                <div class="add-product-review">
                                    <h3 class="text-uppercase heading-text-color font-weight-semibold">{{ producto.nombre|upper }}</h3>

                                    {% for calificacion in calificaciones %}
                                        <table>
                                            <tr>
                                                <td style="width: 100px">
                                                    <div>
                                                        {% if calificacion.rating == 0 %}
                                                            <a style="text-decoration: none" class="fa fa-star-o"></a>
                                                            <a style="text-decoration: none" class="fa fa-star-o"></a>
                                                            <a style="text-decoration: none" class="fa fa-star-o"></a>
                                                            <a style="text-decoration: none" class="fa fa-star-o"></a>
                                                            <a style="text-decoration: none" class="fa fa-star-o"></a>
                                                        {% elif calificacion.rating <= 1.4 %}
                                                            <a style="text-decoration: none" class="fa fa-star"></a>
                                                            <a style="text-decoration: none" class="fa fa-star-o"></a>
                                                            <a style="text-decoration: none" class="fa fa-star-o"></a>
                                                            <a style="text-decoration: none" class="fa fa-star-o"></a>
                                                            <a style="text-decoration: none" class="fa fa-star-o"></a>
                                                        {% elif calificacion.rating <= 2.4 %}
                                                            <a style="text-decoration: none" class="fa fa-star"></a>
                                                            <a style="text-decoration: none" class="fa fa-star"></a>
                                                            <a style="text-decoration: none" class="fa fa-star-o"></a>
                                                            <a style="text-decoration: none" class="fa fa-star-o"></a>
                                                            <a style="text-decoration: none" class="fa fa-star-o"></a>
                                                        {% elif calificacion.rating <= 3.4 %}
                                                            <a style="text-decoration: none" class="fa fa-star"></a>
                                                            <a style="text-decoration: none" class="fa fa-star"></a>
                                                            <a style="text-decoration: none" class="fa fa-star"></a>
                                                            <a  style="text-decoration: none" class="fa fa-star-o"></a>
                                                            <a style="text-decoration: none" class="fa fa-star-o"></a>

                                                        {% elif calificacion.rating <= 4.4 %}
                                                            <a style="text-decoration: none" class="fa fa-star"></a>
                                                            <a style="text-decoration: none" class="fa fa-star"></a>
                                                            <a style="text-decoration: none" class="fa fa-star"></a>
                                                            <a style="text-decoration: none" class="fa fa-star"></a>
                                                            <a style="text-decoration: none" class="fa fa-star-o"></a>
                                                        {% else %}
                                                            <a style="text-decoration: none" class="fa fa-star"></a>
                                                            <a style="text-decoration: none" class="fa fa-star"></a>
                                                            <a style="text-decoration: none" class="fa fa-star"></a>
                                                            <a style="text-decoration: none" class="fa fa-star"></a>
                                                            <a  style="text-decoration: none" class="fa fa-star"></a>
                                                        {% endif %}
                                                    </div>
                                                </td>
                                                <td>{% if calificacion.usuario %}{{ calificacion.usuario }}:{% else %}
                                                    Anonimo:{% endif %}{% if calificacion.comentario %}
                                                    {{ calificacion.comentario }}
                                                {% else %}
                                                    No dejo Comentario
                                                {% endif %}</td>
                                            </tr>


                                        </table>
                                    {% endfor %}

                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <h2 class="slider-title">
                    <span class="inline-title">Also Purchased</span>
                    <span class="line"></span>
                </h2>

                <div class="owl-carousel owl-theme"
                     data-plugin-options="{'items':4, 'margin':20, 'nav':true, 'dots': false, 'loop': false}">
                    <div class="product">
                        <figure class="product-image-area">
                            <a href="#" title="Product Name" class="product-image">
                                <img src="{% static 'Store/img/demos/shop/products/product1.jpg' %}" alt="Product Name">
                                <img src="{% static 'Store/img/demos/shop/products/product1-2.jpg' %}"
                                     alt="Product Name" class="product-hover-image">
                            </a>

                            <a href="#" class="product-quickview">
                                <i class="fa fa-share-square-o"></i>
                                <span>Quick View</span>
                            </a>
                            <div class="product-label"><span class="discount">-10%</span></div>
                            <div class="product-label"><span class="new">New</span></div>
                        </figure>
                        <div class="product-details-area">
                            <h2 class="product-name"><a href="#" title="Product Name">Noa Sheer Blouse</a></h2>
                            <div class="product-ratings">
                                <div class="ratings-box">
                                    <div class="rating" style="width:60%"></div>
                                </div>
                            </div>

                            <div class="product-price-box">
                                <span class="old-price">$99.00</span>
                                <span class="product-price">$89.00</span>
                            </div>

                            <div class="product-actions">
                                <a href="#" class="addtowishlist" title="Add to Wishlist">
                                    <i class="fa fa-heart"></i>
                                </a>
                                <a href="#" class="addtocart" title="Add to Cart">
                                    <i class="fa fa-shopping-cart"></i>
                                    <span>Add to Cart</span>
                                </a>
                                <a href="#" class="comparelink" title="Add to Compare">
                                    <i class="glyphicon glyphicon-signal"></i>
                                </a>
                            </div>
                        </div>
                    </div>


                </div>
            </div>
            <aside class="col-md-3 sidebar product-sidebar">
                <div class="feature-box feature-box-style-3">
                    <div class="feature-box-icon">
                        <i class="fa fa-truck"></i>
                    </div>
                    <div class="feature-box-info">
                        <h4>FREE SHIPPING</h4>
                        <p class="mb-none">Free shipping on all orders over $99.</p>
                    </div>
                </div>

                <div class="feature-box feature-box-style-3">
                    <div class="feature-box-icon">
                        <i class="fa fa-dollar"></i>
                    </div>
                    <div class="feature-box-info">
                        <h4>MONEY BACK GUARANTEE</h4>
                        <p class="mb-none">100% money back guarantee.</p>
                    </div>
                </div>

                <div class="feature-box feature-box-style-3">
                    <div class="feature-box-icon">
                        <i class="fa fa-support"></i>
                    </div>
                    <div class="feature-box-info">
                        <h4>ONLINE SUPPORT 24/7</h4>
                        <p class="mb-none">Lorem ipsum dolor sit amet.</p>
                    </div>
                </div>

                <hr class="mt-xlg">

                <div class="owl-carousel owl-theme" data-plugin-options="{'items':1, 'margin': 5}">
                    <a href="#">
                        <img class="img-responsive" src="{% static 'Store/img/demos/shop/banners/banner1-red.jpg' %}"
                             alt="Banner">
                    </a>

                    <a href="#">
                        <img class="img-responsive" src="{% static 'Store/img/demos/shop/banners/banner2-red.jpg' %}"
                             alt="Banner">
                    </a>

                </div>

                <hr>
            </aside>
        </div>
    </div>
{% endblock %}

{% block script %}
    <script>
        $('.starrr').starrr({
            rating: {% rating_productos producto.id %},
            max: 5,
            readOnly: true
        })
        $('.choice').val({% rating_productos producto.id %});
        $('.choic').text({% rating_productos producto.id %});
        $('.starrr2').starrr({
            rating: {% rating_productos producto.id %},
            max: 5,
            readOnly: false,
            change: function (e, value) {
                if (value) {
                    $('.your-choice-was').show();
                    $('.choice').val(value);
                } else {
                    $('.your-choice-was').hide();
                }
            }
        })
    </script>
    <script>
        $(".product-gallery-item").click(function () {
            console.log($(this).data('image'))
            $("#product-zoom").attr("src", $(this).data('image'))
        })
    </script>





{% endblock %}