{% extends 'Home/index2.html' %}
{% block contenido_index %}
    {% load static %}
    {% load productosTags %}
    {% load mathfilters %}
    <div class="">
        <div class="row">
            <div class="col-md-12 col-sm-12 ">
                <div class="x_panel">
                    <div class="x_title">
                        <h2><small>Documentos de los Establecimientos</small></h2>
                        <div class="clearfix"></div>
                    </div>
                    <div class="x_content">
                        <div class="row">
                            <div class="col-sm-12">
                                <a class="btn btn-danger" href="/store/autority/?establecimiento=0">Todos</a>
                                {% for establecimiento in request.user.establecimiento_set.all %}
                                    <a class="btn btn-primary"
                                       href="/store/autority/?establecimiento={{ establecimiento.id }}">{{ establecimiento.nombreComercial }}</a>
                                {% endfor %}
                                <div class="card-box table-responsive">
                                    <table id="listaDocumentos" class="table table-striped table-bordered"
                                           style="width:100%">
                                        <thead style="background-color: #2A3F54; color: white">
                                        <tr>
                                            <th style="text-align: center">Fecha de la Compra</th>
                                            <th style="text-align: center">CÃ³digo Producto</th>
                                            <th style="text-align: center">Tipo</th>
                                            <th style="text-align: center">Cliente</th>
                                            <th style="text-align: center">Producto</th>
                                            <th style="text-align: center">Cant.</th>
                                            <th style="text-align: center">Pr Normal</th>
                                            <th style="text-align: center">Desc.</th>
                                            <th style="text-align: center">Pr Promo</th>
                                            <th style="text-align: center">IVA</th>
                                            <th style="text-align: center">Total</th>

                                        </tr>
                                        </thead>
                                        <tbody>
                                        {% for documento in comprasweb %}
                                            <tr>
                                            <td style="vertical-align: middle">{{ documento.compra.fecha }}</td>
                                            <td style="text-align: center; vertical-align: middle">{{ documento.producto_id }}</td>
                                            <td style="text-align: center; vertical-align: middle">
                                                <span class="badge badge-success" style="font-size: 13px">Compra por Internet</span>
                                            </td>
                                            <td style="vertical-align: middle">{{ documento.compra.usuario.usuario.first_name }} {{ documento.compra.usuario.usuario.last_name }}</td>
                                            <td style="vertical-align: middle"><span class="badge badge-danger"
                                                                                     style="font-size: 13px">
                                                        {{ documento.producto.nombre }} {% if documento.talla %}
                                                {{ documento.talla }}{% endif %}{% if documento.color %}
                                                {{ documento.color }}{% endif %}</span>
                                            </td>
                                            <td style="vertical-align: middle; text-align: center"><span
                                                    class="badge badge-primary"
                                                    style="font-size: 13px">{{ documento.cantidad }}</span></td>

                                            <td style="text-align: center; vertical-align: middle">{{ documento.precio_normal }}</td>
                                            <td style="text-align: center; vertical-align: middle">{{ documento.descuento_porcentaje }}%</td>
                                            <td style="text-align: center; vertical-align: middle">{{ documento.precio_promocion }}</td>
                                            <td style="text-align: center; vertical-align: middle">{{ documento.iva }}</td>
                                            <td style="text-align: center;; vertical-align: middle"><span
                                                    class="badge badge-danger"
                                                    style="font-size: 13px">{{ documento.total }}</span></td>
                                        {% endfor %}

                                        </tbody>
                                    </table>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

{% endblock %}
{% block script_index %}
    <script>
        $(document).ready(function () {
            $("#listaDocumentos").DataTable({
                language: {
                    url: "{% static 'Spanish_dt.json' %}"
                },
                pageLength: 100,
            });
        });
    </script>
{% endblock %}